
<!DOCTYPE html>
<html lang class="loading">
<head><meta name="generator" content="Hexo 3.8.0">
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>selenium - Hexo</title>
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="google" content="notranslate">
    <meta name="keywords" content="Fechin,"> 
    <meta name="description" content="声明浏览器对象#encoding:uft-8 
from selenium import webdriver
#谷歌、火狐、Safari、win10Edge浏览器
driver = webdrive,"> 
    <meta name="author" content="John Doe"> 
    <link rel="alternative" href="atom.xml" title="Hexo" type="application/atom+xml"> 
    <link rel="icon" href="/img/favicon.png"> 
    <link rel="stylesheet" href="//cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.css">
    <link rel="stylesheet" href="/css/diaspora.css">
    <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
    <script>
         (adsbygoogle = window.adsbygoogle || []).push({
              google_ad_client: "ca-pub-8691406134231910",
              enable_page_level_ads: true
         });
    </script>
    <script async custom-element="amp-auto-ads" src="https://cdn.ampproject.org/v0/amp-auto-ads-0.1.js">
    </script>
</head>
</html>
<body class="loading">
    <span id="config-title" style="display:none">Hexo</span>
    <div id="loader"></div>
    <div id="single">
    <div id="top" style="display: block;">
    <div class="bar" style="width: 0;"></div>
    <a class="icon-home image-icon" href="javascript:;" data-url="https://dreamvlee.github.io/dreamLee.github.io"></a>
    <div title="播放/暂停" class="icon-play"></div>
    <h3 class="subtitle">selenium</h3>
    <div class="social">
        <!--<div class="like-icon">-->
            <!--<a href="javascript:;" class="likeThis active"><span class="icon-like"></span><span class="count">76</span></a>-->
        <!--</div>-->
        <div>
            <div class="share">
                <a title="获取二维码" class="icon-scan" href="javascript:;"></a>
            </div>
            <div id="qr"></div>
        </div>
    </div>
    <div class="scrollbar"></div>
</div>

    <div class="section">
        <div class="article">
    <div class="main">
        <h1 class="title">selenium</h1>
        <div class="stuff">
            <span>四月 04, 2019</span>
            

        </div>
        <div class="content markdown">
            <h1 id="声明浏览器对象"><a href="#声明浏览器对象" class="headerlink" title="声明浏览器对象"></a>声明浏览器对象</h1><pre><code>#encoding:uft-8 
from selenium import webdriver
#谷歌、火狐、Safari、win10Edge浏览器
driver = webdriver.Chrome() 
driver = webdriver.Firefox()
driver = webdriver.Safari()
driver = webdriver.Edge()
#无界面浏览器
browser=webdriver.PhantomJS()
</code></pre><h1 id="访问页面"><a href="#访问页面" class="headerlink" title="访问页面"></a>访问页面</h1><pre><code>driver.get(&quot;http://www.baidu.com&quot;)
#browser.page_source是获取网页的全部html
print（driver.page_source）
</code></pre><h2 id="多选项访问页面"><a href="#多选项访问页面" class="headerlink" title="多选项访问页面"></a>多选项访问页面</h2><pre><code># -*- coding: utf-8 -*-
from selenium import webdriver
import time

driver = webdriver.Chrome()
#b站2019初最佳视频
driver.get(&quot;https://www.bilibili.com/video/av41301960?spm_id_from=333.334.b_686f6d655f706f70756c6172697a65.5&quot;)
driver.execute_script(&quot;window.open()&quot;)
#print(browser.window_handles)
driver.switch_to_window(browser.window_handles[1])
driver.get(&quot;https://www.taobao.com&quot;)
time.sleep(1)
driver.switch_to_window(browser.window_handles[0])
driver.get(&quot;https://baidu.com&quot;)
driver.close()
</code></pre><h1 id="查找元素"><a href="#查找元素" class="headerlink" title="查找元素"></a>查找元素</h1><blockquote>
<p>常用的查找方法</p>
</blockquote>
<ol>
<li>find_element_by_name</li>
<li>find_element_by_xpath</li>
<li>find_element_by_link_text</li>
<li>find_element_by_partial_link_text</li>
<li>find_element_by_tag_name</li>
<li>find_element_by_class_name</li>
<li>find_element_by_css_selector</li>
</ol>
<blockquote>
<p>通用方法</p>
<p>from selenium.webdriver.common.by import By</p>
</blockquote>
<ol>
<li>find_element(BY.ID,’q’)</li>
</ol>
<h2 id="查找单个元素"><a href="#查找单个元素" class="headerlink" title="查找单个元素"></a>查找单个元素</h2><pre><code>from selenium import webdriver
import time

driver = webdriver.Chrome()
driver.get(&quot;https://baidu.com&quot;)
#找到搜索框
search_first = driver.find_element_by_id(&apos;kw&apos;)
search_second = driver.find_element_by_xpath(&apos;//[@class=\&apos;s_ipt\&apos;]&apos;)
search_third = driver.find_element(By.ID,&quot;kw&quot;)
button = driver.find_element_by_id(&apos;su&apos;)

button.click()

time.sleep(3)
driver.close()
</code></pre><h2 id="查找多个元素"><a href="#查找多个元素" class="headerlink" title="查找多个元素"></a>查找多个元素</h2><pre><code>from selenium import webdriver
from selenium.webdriver.common.by import By
browser=webdriver.Chrome()
browser.get(&quot;http://www.taobao.com&quot;)
lis=browser.find_element_by_css_selector(&quot;li&quot;)
lis_c=browser.find_element(By.CSS_SELECTOR,&quot;li&quot;)
print(lis,lis_c)
browser.close()
</code></pre><h1 id="元素的交互操作"><a href="#元素的交互操作" class="headerlink" title="元素的交互操作"></a>元素的交互操作</h1><h2 id="对查找到的元素调用交互操作"><a href="#对查找到的元素调用交互操作" class="headerlink" title="对查找到的元素调用交互操作"></a>对查找到的元素调用交互操作</h2><pre><code>#_*_coding: utf-8_*_
from selenium import webdriver
import time
browser=webdriver.Chrome()
browser.get(&quot;https://www.taobao.com&quot;)
#找到搜索框
input=browser.find_element_by_id(&quot;q&quot;)
input.send_keys(&quot;iPhone&quot;)
time.sleep(10)
#清空搜索框
input.clear()
input.send_keys(&quot;iPad&quot;)
#找到搜索按钮
button=browser.find_element_by_class_name(&quot;btn-search&quot;)
#点击
button.click()
time.sleep(10)
browser.close()
</code></pre><h2 id="动作链（一系列动作）"><a href="#动作链（一系列动作）" class="headerlink" title="动作链（一系列动作）"></a>动作链（一系列动作）</h2><h1 id="执行javascript"><a href="#执行javascript" class="headerlink" title="执行javascript"></a>执行javascript</h1><pre><code>#_*_coding: utf-8_*_
from selenium import webdriver
browser=webdriver.Chrome()
browser.get(&quot;https://www.zhihu.com/explore&quot;)
browser.execute_script(&quot;window.scrollTo(0,document.body.scrollHeight)&quot;)
browser.execute_script(&quot;alert(&apos;To Button&apos;)&quot;)    
browser.close()
</code></pre><h1 id="等待"><a href="#等待" class="headerlink" title="等待"></a>等待</h1><h2 id="隐式等待"><a href="#隐式等待" class="headerlink" title="隐式等待"></a>隐式等待</h2><h2 id="显示等待"><a href="#显示等待" class="headerlink" title="显示等待"></a>显示等待</h2><pre><code>driver = webdriver.Chrome()
driver.get(&quot;http://www.baidu.com&quot;)
driver.implicitly_wait(10)
#控制在10秒以内
elem = WebDriverWait(driver, 5).until(EC.presence_of_element_located((By.ID,&quot;kw&quot;)))
#最多等15秒
elem.send_keys(&quot;selenium&quot;)
time.sleep(3)
driver.close()
</code></pre><h1 id="前进与后退"><a href="#前进与后退" class="headerlink" title="前进与后退"></a>前进与后退</h1><pre><code># -*- coding: utf-8 -*-
from selenium import webdriver
import time

browser = webdriver.Chrome()
browser.get(&quot;https://www.taobao.com&quot;)
browser.get(&quot;https://www.baidu.com&quot;)
browser.get(&quot;https://www.bilibili.com/&quot;)
browser.back()
time.sleep(1)
browser.forward()
browser.close()
</code></pre><h1 id="Cookies"><a href="#Cookies" class="headerlink" title="Cookies"></a>Cookies</h1><h1 id="异常处理"><a href="#异常处理" class="headerlink" title="异常处理"></a>异常处理</h1><h1 id="鼠标键盘操作"><a href="#鼠标键盘操作" class="headerlink" title="鼠标键盘操作"></a>鼠标键盘操作</h1><ol>
<li>click(on_element=None) ——单击鼠标左键</li>
<li>click_and_hold(on_element=None) ——点击鼠标左键，不松开</li>
<li>context_click(on_element=None) ——点击鼠标右键</li>
<li>double_click(on_element=None) ——双击鼠标左键</li>
<li>drag_and_drop(source, target) ——拖拽到某个元素然后松开</li>
<li>drag_and_drop_by_offset(source, xoffset, yoffset) ——拖拽到某个坐标然后松开</li>
<li>key_down(value, element=None) ——按下某个键盘上的键</li>
<li>key_up(value, element=None) ——松开某个键</li>
<li>move_by_offset(xoffset, yoffset) ——鼠标从当前位置移动到某个坐标</li>
<li>move_to_element(to_element) ——鼠标移动到某个元素</li>
<li>move_to_element_with_offset(to_element, xoffset, yoffset) ——移动到距某个元素（左上角坐标）多少距离的位置</li>
<li>perform() ——执行链中的所有动作</li>
<li>release(on_element=None) ——在某个元素位置松开鼠标左键</li>
<li>send_keys(*keys_to_send) ——发送某个键到当前焦点的元素</li>
<li><p>send_keys_to_element(element, *keys_to_send) ——发送某个键到指定元素</p>
<pre><code>from selenium import webdriver
from selenium.webdriver.common.action_chains import ActionChains
import time

driver = webdriver.Chrome()

driver.get(&quot;https://www.baidu.com/&quot;)

above = driver.find_element_by_link_text(u&quot;设置&quot;)

ActionChains(driver).move_to_element(above).perform()

driver.find_element_by_id(&quot;kw&quot;).send_keys(&apos;NIHAO&apos;)
driver.find_element_by_id(&quot;kw&quot;).send_keys(Keys.CONTROL,&apos;a &apos;)
time.sleep(3)
driver.find_element_by_id(&quot;kw&quot;).send_keys(Keys.CONTROL,&apos;c &apos;)
time.sleep(3)
driver.find_element_by_id(&quot;kw&quot;).send_keys(Keys.BACK_SPACE)
time.sleep(3)
driver.find_element_by_id(&quot;kw&quot;).send_keys(Keys.CONTROL,&apos;v &apos;)

time.sleep(3)

driver.close()
</code></pre></li>
</ol>
<h1 id="样例"><a href="#样例" class="headerlink" title="样例"></a>样例</h1><blockquote>
<p>为了尽可能全面的使用前面的知识</p>
<p>案例是打开B站，搜索英雄联盟CG，然后跳转到新的选项卡，快照。<br>然后回到初始选项卡，执行后退操作。</p>
</blockquote>
<pre><code># -*- coding: utf-8 -*-
from selenium import webdriver
from selenium.webdriver.common.action_chains import ActionChains
import time
driver = webdriver.Chrome()
driver.maximize_window()
driver.get(&quot;https://www.bilibili.com/&quot;)
#使用javascript，向下滑动
#因为未登录B站时候，会弹出登录框，影响点击操作
driver.execute_script(&quot;window.scrollTo    (0,document.body.scrollHeight)&quot;)
search = driver.find_element_by_xpath(&apos;//*[@class=\&apos;search-keyword\&apos;]&apos;)
button = driver.find_element_by_xpath(&apos;//*[@class=\&apos;search-submit\&apos;]&apos;)
#B站的搜索框一般都有placeholder
search.clear()
search.send_keys(u&apos;英雄联盟CG&apos;)
#动作链
action = ActionChains(driver)
#由于直接button.click（）不能打开页面
#将鼠标移至点击按钮并点击
action.move_to_element(button).click().perform()
#移动到新选项卡
driver.switch_to_window(driver.window_handles[1])
#快照
driver.get_screenshot_as_file(&apos;1.jpg&apos;)
time.sleep(3)
driver.switch_to_window(driver.window_handles[0])
driver.get(&quot;https://www.baidu.com&quot;)
time.sleep(2)
driver.back()
driver.close()
</code></pre>
            <!--[if lt IE 9]><script>document.createElement('audio');</script><![endif]-->
            <audio id="audio" loop="1" preload="auto" controls="controls" data-autoplay="false">
                <source type="audio/mpeg" src>
            </audio>
            
                <ul id="audio-list" style="display:none">
                    
                        <li title="0" data-url="http://link.hhtjim.com/163/5146554.mp3"></li>
                    
                        <li title="1" data-url="http://link.hhtjim.com/qq/001faIUs4M2zna.mp3"></li>
                    
                </ul>
            
        </div>
        
    <div id="gitalk-container" class="comment link" data-ae="false" data-ci data-cs data-r data-o data-a data-d="false">查看评论</div>


    </div>
    
</div>


    </div>
</div>
</body>
<script src="//cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.js"></script>
<script src="//lib.baomitu.com/jquery/1.8.3/jquery.min.js"></script>
<script src="/js/plugin.js"></script>
<script src="/js/diaspora.js"></script>
<link rel="stylesheet" href="/photoswipe/photoswipe.css">
<link rel="stylesheet" href="/photoswipe/default-skin/default-skin.css">
<script src="/photoswipe/photoswipe.min.js"></script>
<script src="/photoswipe/photoswipe-ui-default.min.js"></script>

<!-- Root element of PhotoSwipe. Must have class pswp. -->
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">
    <!-- Background of PhotoSwipe. 
         It's a separate element as animating opacity is faster than rgba(). -->
    <div class="pswp__bg"></div>
    <!-- Slides wrapper with overflow:hidden. -->
    <div class="pswp__scroll-wrap">
        <!-- Container that holds slides. 
            PhotoSwipe keeps only 3 of them in the DOM to save memory.
            Don't modify these 3 pswp__item elements, data is added later on. -->
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>
        <!-- Default (PhotoSwipeUI_Default) interface on top of sliding area. Can be changed. -->
        <div class="pswp__ui pswp__ui--hidden">
            <div class="pswp__top-bar">
                <!--  Controls are self-explanatory. Order can be changed. -->
                <div class="pswp__counter"></div>
                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
                <button class="pswp__button pswp__button--share" title="Share"></button>
                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>
                <!-- Preloader demo http://codepen.io/dimsemenov/pen/yyBWoR -->
                <!-- element will get class pswp__preloader--active when preloader is running -->
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                      <div class="pswp__preloader__cut">
                        <div class="pswp__preloader__donut"></div>
                      </div>
                    </div>
                </div>
            </div>
            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div> 
            </div>
            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>
            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>
            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>
        </div>
    </div>
</div>




</html>
